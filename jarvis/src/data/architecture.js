// Finance-X Architecture Data
// This file contains the structure of the Finance-X terminal codebase

export const modules = {
  core: [
    {
      id: 'server',
      name: 'server.py',
      description: 'Main FastAPI server - routes HTTP requests, command parsing, session management',
      path: '/Users/aayush/Finance-X-/server.py',
      type: 'core',
      lines: 650,
      dependencies: ['engine', 'india_engine', 'bloomberg_engine', 'study_engine', 'analyst', 'user_data'],
      endpoints: ['/command', '/status', '/market', '/system/diagnostics'],
      layer: 'API Layer',
      purpose: 'Central routing hub that receives all client requests and dispatches them to appropriate engines based on command type',
      dataFlow: {
        inputs: ['HTTP requests from Terminal UI', 'WebSocket connections'],
        outputs: ['JSON responses', 'Market data', 'Analysis results'],
      },
      processFlow: {
        steps: [
          'Receive HTTP/WebSocket Request',
          'Authenticate Session (Auth Middleware)',
          'Parse Command & Parameters',
          'Route to Appropriate Engine (e.g., Engine, India, Study)',
          'Format Response JSON',
          'Send back to Client'
        ],
        impact: 'Failure here blocks ALL external access to the system.'
      },
      commands: ['TODAY', 'NIFTY', 'FX', 'SECTORS', 'MOVERS', 'STUDY', 'CHART', 'EVAL'],
      framework: 'FastAPI',
      port: 8000,
    },
    {
      id: 'bloomberg_service',
      name: 'bloomberg_service.py',
      description: 'Standalone Bloomberg microservice API on port 8001',
      path: '/Users/aayush/Finance-X-/bloomberg_service.py',
      type: 'core',
      lines: 180,
      dependencies: ['bloomberg_engine'],
      endpoints: ['/health', '/fx-rates', '/sectors', '/economic-calendar', '/screen', '/top-movers'],
      layer: 'API Layer',
      purpose: 'Independent microservice for Bloomberg-style features, enabling separate scaling and deployment',
      dataFlow: {
        inputs: ['HTTP requests for Bloomberg data'],
        outputs: ['FX rates', 'Sector performance', 'Market screener results'],
      },
      framework: 'FastAPI',
      port: 8001,
    },
    {
      id: 'main',
      name: 'main.py',
      description: 'Alternative CLI entry point for headless simulation',
      path: '/Users/aayush/Finance-X-/main.py',
      type: 'core',
      lines: 60,
      dependencies: ['engine', 'analyst'],
      layer: 'Application Layer',
      purpose: 'CLI-based simulation runner for testing without web interface',
      dataFlow: {
        inputs: ['Command line arguments'],
        outputs: ['Console output', 'Simulation results'],
      },
    },
    {
      id: 'terminal_ui',
      name: 'terminal_ui.py',
      description: 'Terminal UI server for alternative interface',
      path: '/Users/aayush/Finance-X-/terminal_ui.py',
      type: 'core',
      lines: 380,
      dependencies: ['engine'],
      layer: 'Presentation Layer',
      purpose: 'Alternative terminal-style interface for command execution',
    },
  ],
  engines: [
    {
      id: 'engine',
      name: 'engine.py',
      description: 'Core intelligence engine - risk detection, market simulation, technical analysis',
      path: '/Users/aayush/Finance-X-/engine.py',
      type: 'engine',
      lines: 280,
      classes: ['IntelligenceEngine', 'MarketSimulator', 'TankerSimulator', 'TechnicalAnalysis'],
      functions: ['ingest', 'apply_decay', 'detect_state', 'update_prices', 'get_ticker'],
      layer: 'Business Logic Layer',
      purpose: 'Central brain of the system - processes market events, calculates risk scores, and determines system state',
      dataFlow: {
        inputs: ['Market events', 'Time progression', 'Price updates'],
        outputs: ['System state (STABLE/HIGH_VOL/CRASH)', 'Risk scores', 'Ticker data'],
      },
      processFlow: {
        steps: [
          'Ingest Market Event (Price change, News)',
          'Calculate Decay Factors (Time-based)',
          'Update Risk Scores per Asset',
          'Determine System State (Normal vs Crash)',
          'Trigger Alerts if Thresholds Breached'
        ],
        impact: 'Incorrect risk scores leading to false alerts or missed crash detection.'
      },
      algorithms: [
        'Exponential decay: weight = score × e^(-rate × time)',
        'Risk classification: >25 = CRASH, >15 = HIGH_VOL, <15 = STABLE',
        'Bollinger Bands calculation',
      ],
      trackedAssets: ['SPX', 'NDX', 'BTC', 'VIX', 'AAPL', 'NVDA', 'JPM', 'XOM', 'WTI'],
    },
    {
      id: 'india_engine',
      name: 'india_engine.py',
      description: 'Real-time NSE market data - NIFTY 50 stocks via yfinance',
      path: '/Users/aayush/Finance-X-/india_engine.py',
      type: 'engine',
      lines: 220,
      classes: ['IndiaMarketEngine'],
      functions: ['fetch_market_snapshot', 'get_stock_analysis', 'check_portfolio_health'],
      layer: 'Business Logic Layer',
      purpose: 'Real-time bridge to Indian stock market (NSE) - fetches live data for 49 NIFTY 50 stocks',
      dataFlow: {
        inputs: ['yfinance API calls', 'Stock symbols'],
        outputs: ['Market snapshot', 'Stock analysis', 'Portfolio health alerts'],
      },
      processFlow: {
        steps: [
          'Grid Fetch 50 NIFTY Tickers (Batch)',
          'Calculate Technicals (SMA, RSI)',
          'Detect Outliers (>2% move)',
          'Compare against Watchlist',
          'Push Updates to Frontend'
        ],
        impact: 'Loss of real-time Indian market data visibility.'
      },
      cacheStrategy: '60-second TTL cache to prevent API overload',
      trackedStocks: 49,
      features: ['SMA-5/SMA-20 calculation', 'Trend detection', 'Volume analysis', 'Stop-loss monitoring'],
    },
    {
      id: 'bloomberg_engine',
      name: 'bloomberg_engine.py',
      description: 'Bloomberg-style features - FX rates, sectors, screener, economic calendar',
      path: '/Users/aayush/Finance-X-/bloomberg_engine.py',
      type: 'engine',
      lines: 300,
      classes: ['BloombergEngine'],
      functions: ['get_fx_rates', 'get_sector_performance', 'screen_stocks', 'get_economic_calendar', 'get_top_movers'],
      layer: 'Business Logic Layer',
      purpose: 'Professional Bloomberg-style market features for advanced analysis',
      dataFlow: {
        inputs: ['yfinance API for FX and sectors', 'Screening criteria'],
        outputs: ['8 FX pairs', '10 sector ETFs', 'Screened stocks', 'Economic events'],
      },
      processFlow: {
        steps: [
          'Fetch FX Rates (USD/INR, EUR/USD)',
          'Aggregate Sector Performance',
          'Run Screener Logic (Gainers/Losers)',
          'Format Economic Calendar Events',
          'Cache Results (5min TTL)'
        ],
        impact: 'Loss of global context and sector rotation analysis.'
      },
      fxPairs: ['USD/INR', 'EUR/USD', 'GBP/USD', 'USD/JPY', 'EUR/INR', 'GBP/INR', 'BTC/USD', 'ETH/USD'],
      sectorETFs: ['XLK', 'XLF', 'XLE', 'XLV', 'XLI', 'XLY', 'XLU', 'XLRE', 'XLB', 'XLC'],
      screenerCriteria: ['GAINERS', 'LOSERS', 'VOLUME', 'VOLATILE'],
    },
    {
      id: 'study_engine',
      name: 'study_engine.py',
      description: 'News aggregation and educational resources from RSS feeds',
      path: '/Users/aayush/Finance-X-/study_engine.py',
      type: 'engine',
      lines: 280,
      classes: ['StudyEngine'],
      functions: ['fetch_live_news', 'get_study_resources', 'get_glossary'],
      layer: 'Business Logic Layer',
      purpose: 'Financial news aggregation with sentiment analysis and educational resources',
      dataFlow: {
        inputs: ['RSS feeds from Yahoo Finance, MarketWatch, Reuters, Bloomberg'],
        outputs: ['Analyzed news with sentiment', 'Study resources', 'Glossary terms'],
      },
      processFlow: {
        steps: [
          'Poll RSS Feeds (Yahoo, Reuters)',
          'Parse XML Content',
          'Run Keyword Sentiment Analysis',
          'Tag with Tickers/Sectors',
          'Store in Database & Feed'
        ],
        impact: 'News feed stays stale; no sentiment correlation.'
      },
      newsSources: ['Yahoo Finance RSS', 'MarketWatch RSS', 'Reuters Business RSS', 'Bloomberg Markets RSS'],
      sentimentTypes: ['BULLISH', 'BEARISH', 'NEUTRAL'],
      studyCategories: ['Technical Analysis', 'Fundamental Analysis', 'Options Trading', 'Risk Management', 'Market Psychology'],
    },
    {
      id: 'performance_engine',
      name: 'performance_engine.py',
      description: 'Hardware optimization and vectorized calculations with NumPy',
      path: '/Users/aayush/Finance-X-/performance_engine.py',
      type: 'engine',
      lines: 110,
      classes: ['HardwareNavigator', 'PerformanceEngine'],
      functions: ['get_system_metrics', 'determine_fidelity_level', 'calculate_bollinger_bands_vectorized'],
      layer: 'Infrastructure Layer',
      purpose: 'Hardware-aware optimization for vectorized mathematical operations',
      dataFlow: {
        inputs: ['System metrics (CPU, memory)', 'Price data arrays'],
        outputs: ['Fidelity levels (ULTRA/HIGH/EFFICIENT)', 'Vectorized calculations'],
      },
      performanceGains: {
        bollingerBands: '50x faster',
        priceUpdates: '100x faster for 50+ tickers',
        decayCalculation: '80x faster for 100+ events',
      },
      fidelityLevels: ['ULTRA (<30% CPU)', 'HIGH (30-70% CPU)', 'EFFICIENT (>70% CPU)'],
    },
  ],
  support: [
    {
      id: 'analyst',
      name: 'analyst.py',
      description: 'Event analysis and human-readable explanations',
      path: '/Users/aayush/Finance-X-/analyst.py',
      type: 'support',
      lines: 70,
      classes: ['Analyst'],
      functions: ['explain_event', 'explain_situation'],
      layer: 'Business Logic Layer',
      purpose: 'Generates human-readable analysis and explanations for market events',
      dataFlow: {
        inputs: ['Market events', 'System snapshots'],
        outputs: ['Human-readable explanations', 'Impact analysis'],
      },
    },
    {
      id: 'models',
      name: 'models.py',
      description: 'Data structure definitions - MarketEvent, Ticker, SystemState',
      path: '/Users/aayush/Finance-X-/models.py',
      type: 'support',
      lines: 45,
      classes: ['MarketEvent', 'ProcessedEvent', 'SystemState', 'MarketRegime', 'Ticker', 'PricePoint'],
      layer: 'Data Layer',
      purpose: 'Core data structures providing type safety and consistency across all modules',
      modelDetails: {
        MarketEvent: 'timestamp, event_type, description, base_impact, sector',
        ProcessedEvent: 'original_event, current_weight',
        SystemState: 'STABLE, VOLATILE, HIGH_VOL, CRASH',
        Ticker: 'symbol, name, current_price, change_pct, history',
      },
    },
    {
      id: 'database',
      name: 'database.py',
      description: 'SQLite database management for events and states',
      path: '/Users/aayush/Finance-X-/database.py',
      type: 'support',
      lines: 85,
      classes: ['DatabaseManager'],
      functions: ['initialize_db', 'log_event', 'log_state', 'get_recent_events'],
      layer: 'Data Layer',
      purpose: 'Persistent storage management for historical analysis and audit trails',
      tables: ['events', 'system_states', 'price_history'],
      database: 'SQLite',
    },
    {
      id: 'user_data',
      name: 'user_data.py',
      description: 'User portfolio management and position tracking',
      path: '/Users/aayush/Finance-X-/user_data.py',
      type: 'support',
      lines: 70,
      classes: ['UserManager'],
      functions: ['add_position', 'get_portfolio', 'remove_position'],
      layer: 'Data Layer',
      purpose: 'User portfolio tracking for disruption monitoring and position management',
      tables: ['positions'],
      database: 'users.db',
    },
  ],
  extensions: [
    {
      id: 'ext_yfinance',
      name: 'yfinance_data.py',
      description: 'Live market data feed wrapper for yfinance API',
      path: '/Users/aayush/Finance-X-/extensions/yfinance_data.py',
      type: 'extension',
      lines: 90,
      layer: 'External Integration',
      purpose: 'Wrapper for yfinance API providing real-time and historical market data',
      dataFlow: {
        inputs: ['Stock symbols', 'Date ranges'],
        outputs: ['Real-time prices', 'Historical OHLCV data'],
      },
    },
    {
      id: 'ext_wri',
      name: 'wri_aqueduct.py',
      description: 'WRI Aqueduct water risk integration',
      path: '/Users/aayush/Finance-X-/extensions/wri_aqueduct.py',
      type: 'extension',
      lines: 120,
      layer: 'External Integration',
      purpose: 'Water risk analysis for commodity logistics and port operations',
      features: ['Port water stress analysis', 'Regional commodity risk', 'Alert generation'],
    },
    {
      id: 'ext_audit',
      name: 'audit.py',
      description: 'Audit trail and logging system',
      path: '/Users/aayush/Finance-X-/extensions/audit.py',
      type: 'extension',
      lines: 60,
      layer: 'Infrastructure Layer',
      purpose: 'Comprehensive audit logging for all user actions and state changes',
      features: ['Command logging', 'State transition tracking', 'Audit report generation'],
    },
    {
      id: 'ext_commands',
      name: 'command_handlers.py',
      description: 'Custom command processors and handlers',
      path: '/Users/aayush/Finance-X-/extensions/command_handlers.py',
      type: 'extension',
      lines: 100,
      layer: 'Application Layer',
      purpose: 'Extensible command processing system for custom commands',
    },
    {
      id: 'ext_persistence',
      name: 'persistence.py',
      description: 'Data persistence and export operations',
      path: '/Users/aayush/Finance-X-/extensions/persistence.py',
      type: 'extension',
      lines: 80,
      layer: 'Data Layer',
      purpose: 'Data export and persistence operations for analysis',
      exportFormats: ['CSV', 'JSON'],
    },
  ],
  data: [
    {
      id: 'finance_db',
      name: 'finance.db',
      description: 'SQLite database for market data and events',
      path: '/Users/aayush/Finance-X-/finance.db',
      type: 'data',
      size: '2.9 MB',
      layer: 'Data Storage',
      purpose: 'Primary database storing market events, price history, and system states',
      tables: ['events', 'system_states', 'price_history'],
    },
    {
      id: 'users_db',
      name: 'users.db',
      description: 'SQLite database for user portfolios',
      path: '/Users/aayush/Finance-X-/users.db',
      type: 'data',
      size: '16 KB',
      layer: 'Data Storage',
      purpose: 'User data storage for portfolio positions and preferences',
      tables: ['positions'],
    },
  ],
  frontend: [
    {
      id: 'index_html',
      name: 'index.html',
      description: 'Main terminal UI interface',
      path: '/Users/aayush/Finance-X-/static/index.html',
      type: 'frontend',
      layer: 'Presentation Layer',
      purpose: 'Bloomberg-style terminal interface with command input and output display',
      features: ['Terminal header with system status', 'Command input area', 'Output display panel', 'Responsive grid layouts'],
    },
    {
      id: 'terminal_js',
      name: 'terminal.js',
      description: 'Terminal logic and rendering',
      path: '/Users/aayush/Finance-X-/static/terminal.js',
      type: 'frontend',
      layer: 'Presentation Layer',
      purpose: 'Client-side JavaScript handling command execution and response rendering',
      functions: ['sendCommand', 'renderResponse', 'updateStatus', 'renderChart', 'renderGrid'],
      responseTypes: ['TABLE', 'CHART_FULL', 'OVERVIEW_GRID', 'FX_VIEW', 'SECTORS_VIEW', 'NEWS_FEED', 'STUDY_VIEW'],
    },
    {
      id: 'terminal_css',
      name: 'terminal.css',
      description: 'Terminal styling - dark Bloomberg theme',
      path: '/Users/aayush/Finance-X-/static/terminal.css',
      type: 'frontend',
      layer: 'Presentation Layer',
      purpose: 'Professional Bloomberg-style dark theme with monospace fonts and color-coded data',
      designFeatures: ['Dark theme', 'Monospace fonts', 'Green/red color coding', 'Glassmorphism effects'],
    },
  ],
};

export const getAllModules = () => {
  return [
    ...modules.core,
    ...modules.engines,
    ...modules.support,
    ...modules.extensions,
    ...modules.data,
    ...modules.frontend,
  ];
};

export const getModuleById = (id) => {
  return getAllModules().find(m => m.id === id);
};
